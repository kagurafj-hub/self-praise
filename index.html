<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ä¸€æ—¥è‡ªåˆ†è¤’ã‚æ—¥è¨˜</title>
  <style>
:root {
  --bg-base: #FAF7F5;        /* ã‚·ãƒ£ãƒ³ãƒ‘ãƒ³ */
  --accent-main: #BFA6C8;   /* ã‚¢ãƒ¡ã‚¸ã‚¹ãƒˆ */
  --accent-sub: #E8B7C6;    /* ãƒ­ãƒ¼ã‚ºã‚¯ã‚©ãƒ¼ãƒ„ */
  --text-main: #3A2E39;
  --text-muted: #7A6B76;
  --card-bg: #FFFFFF;
  --border-soft: #E6DFE3;
}
    body { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", "Noto Sans JP", sans-serif; margin: 0;
  background: var(--bg-base);
  color: var(--text-main);
}

    header { padding: 18px 16px; background:#fff; position: sticky; top:0; border-bottom:1px solid #eee; }
    h1 { font-size: 18px; margin:0; }
    main { padding: 16px; max-width: 760px; margin: 0 auto; }
    .card {   background: var(--card-bg);
  border: 1px solid var(--border-soft); border-radius: 12px; padding: 14px; margin: 12px 0; }
    label { display:block; font-size: 13px; margin: 10px 0 6px; color:#555; }
    textarea, input[type="text"] { width: 100%; box-sizing:border-box; padding: 12px; border:1px solid #ddd; border-radius:10px; font-size: 16px; background:#fff; }
    textarea { min-height: 110px; resize: vertical; }
    .row { display:flex; gap:10px; flex-wrap: wrap; }
    button { border:0; border-radius: 10px; padding: 12px 14px; font-size: 15px; cursor: pointer; }
.primary {
  background: var(--accent-main);
  color: #fff;
}
.ghost {
  background: #f2f2f7;
  color: var(--text-main);
}
    .danger { background:#ffe7ea; color:#b00020; }
    .small { padding: 9px 10px; font-size: 14px; border-radius: 9px; }
    .muted { color:#666; font-size: 13px; }
    .entry { border-top:1px dashed #eee; padding-top: 12px; margin-top: 12px; }
    .entry:first-child { border-top:0; padding-top:0; margin-top:0; }
    .date { font-weight: 700; }
    .pill { display:inline-block; background:#f4f0ff; color:#4a33cc; padding: 4px 8px; border-radius: 999px; font-size: 12px; margin-left: 8px;}
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

/* ===== å¤œæ˜ã‘UI ===== */
@media (prefers-color-scheme: dark) {
  :root {
    --bg-base: #1e1b2e;        /* å¤œã®ç´« */
    --card-bg: #2a2542;
    --accent-main: #c8b6ff;   /* å¤œæ˜ã‘ã®å…‰ */
    --accent-sub: #f2b8c6;    /* æ·¡ã„ãƒ­ãƒ¼ã‚º */
    --text-main: #f5f3ff;
    --text-muted: #b6b1d6;
    --border-soft: #3a3560;
  }

  body {
    background:
      radial-gradient(
        1200px 600px at 50% -10%,
        rgba(242,184,198,0.12),
        transparent 60%
      ),
      var(--bg-base);
  }

  header {
    background: rgba(42,37,66,0.85);
    backdrop-filter: blur(6px);
    border-bottom: 1px solid var(--border-soft);
  }

  .card {
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  }

  textarea,
  input[type="text"] {
    background: #1b1730;
    color: var(--text-main);
    border: 1px solid var(--border-soft);
  }

  .ghost {
    background: #3a3560;
    color: var(--text-main);
  }

  .danger {
    background: rgba(176,0,32,0.25);
    color: #ffb4c8;
  }

  .pill {
    background: rgba(200,182,255,0.25);
    color: #e9e3ff;
  }
}
  </style>
</head>
<body>
  <header>
    <h1>ä¸€æ—¥è‡ªåˆ†è¤’ã‚æ—¥è¨˜ <span class="pill">ç«¯æœ«ä¿å­˜</span></h1>
    <div class="muted" id="todayLine"></div>
  </header>

  <main>
    <div class="card">
      <div class="row" style="align-items:center; justify-content:space-between;">
        <div>
          <div class="muted">ä»Šæ—¥ã®ãƒ†ãƒ¼ãƒï¼ˆä»»æ„ï¼‰</div>
          <div id="themePreview" style="font-weight:700; margin-top:4px;">â€”</div>
        </div>
        <button class="ghost small" id="suggestBtn">è¤’ã‚ã®ãƒ’ãƒ³ãƒˆ</button>
      </div>

      <label for="theme">ãƒ†ãƒ¼ãƒï¼ˆä¾‹ï¼šä»•äº‹ï¼å®¶äº‹ï¼å¥åº·ï¼å­¦ã³ï¼å¯¾äººï¼‰</label>
      <input id="theme" type="text" placeholder="ä¾‹ï¼šå­¦ã³ / ä»•äº‹ / å®¶äº‹" />

      <label for="text">ä»Šæ—¥ã®ã€Œè‡ªåˆ†ã‚’è¤’ã‚ãŸã„ã“ã¨ã€</label>
      <textarea id="text" placeholder="ä¾‹ï¼šå¯’ã„ä¸­ã§ã‚‚å¤–å‡ºã—ã¦ã‚„ã‚‹ã¹ãç”¨äº‹ã‚’æ¸ˆã¾ã›ãŸã€‚&#10;ä¾‹ï¼š5åˆ†ã ã‘ã§ã‚‚ç‰‡ä»˜ã‘ã‚’ã—ãŸã€‚"></textarea>

      <label for="score">è‡ªå·±è‚¯å®šæ„Ÿã‚¹ã‚³ã‚¢ï¼ˆ1ã€œ5ï¼‰</label>
      <input id="score" type="range" min="1" max="5" value="3" />
      <div class="muted">ã„ã¾ã®æ°—åˆ†ï¼š<span id="scoreLabel" class="mono">3</span>/5</div>

      <div class="row" style="margin-top:12px;">
        <button class="primary" id="saveBtn">ä¿å­˜</button>
        <button class="ghost" id="exportBtn">æ›¸ãå‡ºã—ï¼ˆJSONï¼‰</button>
        <button class="ghost" id="importBtn">èª­ã¿è¾¼ã¿ï¼ˆJSONï¼‰</button>
        <button class="danger" id="clearBtn">å…¨å‰Šé™¤</button>
      </div>
      <div class="muted" style="margin-top:10px;">
        â€»ãƒ‡ãƒ¼ã‚¿ã¯ã“ã®ç«¯æœ«ã®ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ï¼‰ã€‚
      </div>
    </div>

    <div class="card">
      <div class="row" style="align-items:center; justify-content:space-between;">
        <div style="font-weight:700;">å±¥æ­´</div>
        <div class="muted">åˆè¨ˆ <span id="count">0</span> ä»¶</div>
      </div>
      <div class="row" style="margin-top:10px;">
        <input id="search" type="text" placeholder="æ¤œç´¢ï¼ˆä¾‹ï¼šä»•äº‹ã€å®¶äº‹ï¼‰" style="flex:1;" />
        <button class="ghost small" id="todayBtn">ä»Šæ—¥ã¸</button>
      </div>
      <div id="list" style="margin-top:12px;"></div>
    </div>
  </main>

<script>
  const KEY = "selfPraiseDiary.v1";
  const $ = (id) => document.getElementById(id);

  const today = new Date();
  const fmtDate = (d) => {
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,"0");
    const day = String(d.getDate()).padStart(2,"0");
    return `${y}-${m}-${day}`;
  };

  const load = () => {
    try { return JSON.parse(localStorage.getItem(KEY) || "[]"); }
    catch { return []; }
  };
  const saveAll = (arr) => localStorage.setItem(KEY, JSON.stringify(arr));

  const render = () => {
    const q = $("search").value.trim().toLowerCase();
    const arr = load().sort((a,b)=> b.ts - a.ts);
    const filtered = q
      ? arr.filter(e => (e.theme + " " + e.text).toLowerCase().includes(q))
      : arr;

    $("count").textContent = String(arr.length);
    const list = $("list");
    list.innerHTML = "";

    if (filtered.length === 0) {
      list.innerHTML = `<div class="muted">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ä»Šæ—¥ã®è‡ªåˆ†ã‚’ã²ã¨ã¤è¤’ã‚ã¾ã—ã‚‡ã†ã€‚</div>`;
      return;
    }

    filtered.forEach((e) => {
      const d = new Date(e.ts);
      const wrap = document.createElement("div");
      wrap.className = "entry";
      wrap.innerHTML = `
        <div class="row" style="align-items:center; justify-content:space-between;">
          <div class="date">${fmtDate(d)} <span class="pill">ã‚¹ã‚³ã‚¢ ${e.score}/5</span></div>
          <div class="row">
            <button class="ghost small" data-edit="${e.id}">ç·¨é›†</button>
            <button class="danger small" data-del="${e.id}">å‰Šé™¤</button>
          </div>
        </div>
        <div class="muted" style="margin-top:6px;">ãƒ†ãƒ¼ãƒï¼š${escapeHtml(e.theme || "â€”")}</div>
        <div style="white-space:pre-wrap; margin-top:10px;">${escapeHtml(e.text)}</div>
      `;
      list.appendChild(wrap);
    });

    list.querySelectorAll("[data-del]").forEach(btn=>{
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-del");
        const arr = load().filter(e=> e.id !== id);
        saveAll(arr);
        render();
      });
    });

    list.querySelectorAll("[data-edit]").forEach(btn=>{
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-edit");
        const arr = load();
        const e = arr.find(x=> x.id === id);
        if (!e) return;
        $("theme").value = e.theme || "";
        $("text").value = e.text || "";
        $("score").value = e.score || 3;
        $("scoreLabel").textContent = $("score").value;
        $("themePreview").textContent = $("theme").value || "â€”";
        $("saveBtn").textContent = "æ›´æ–°";
        $("saveBtn").setAttribute("data-editing", id);
        window.scrollTo({ top: 0, behavior:"smooth" });
      });
    });
  };

  const escapeHtml = (s) =>
    (s ?? "").replace(/[&<>"']/g, (c) => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[c]));

  const hintPool = [
    "ä»Šæ—¥ã€ã¡ã‚ƒã‚“ã¨èµ·ããŸ / å‡ºã‹ã‘ãŸ",
    "å°ã•ãã¦ã‚‚å®¶äº‹ã‚’é€²ã‚ãŸ",
    "èª°ã‹ã«ä¸å¯§ã«è¿”ä¿¡ã—ãŸ",
    "ä»•äº‹ã®ä¸€æ­©ã‚’é€²ã‚ãŸï¼ˆ5åˆ†ã§ã‚‚OKï¼‰",
    "ä½“ã‚’ã„ãŸã‚ã£ãŸï¼ˆæ°´ã‚’é£²ã‚“ã ã€ä¼‘ã‚“ã ï¼‰",
    "å­¦ã³ã‚’ç¶šã‘ãŸï¼ˆ1è¡Œã§ã‚‚èª­ã‚“ã ï¼‰",
    "æœªæ¥ã®è‡ªåˆ†ãŒåŠ©ã‹ã‚‹æº–å‚™ã‚’ã—ãŸ",
    "å«Œãªã“ã¨ã‚’é¿ã‘ãšã«å¯¾å‡¦ã—ãŸ",
    "è‡ªåˆ†ã®æ°—æŒã¡ã«æ°—ã¥ã‘ãŸãƒ»è¨€èªåŒ–ã§ããŸ"
  ];

  $("todayLine").textContent = `ä»Šæ—¥ã¯ ${fmtDate(today)}ã€‚ã²ã¨ã¤ã§ã„ã„ã®ã§ã€è‡ªåˆ†ã‚’è¤’ã‚ã¾ã—ã‚‡ã†ã€‚`;

  $("score").addEventListener("input", () => {
    $("scoreLabel").textContent = $("score").value;
  });

  $("theme").addEventListener("input", () => {
    $("themePreview").textContent = $("theme").value || "â€”";
  });

  $("suggestBtn").addEventListener("click", () => {
    const hint = hintPool[Math.floor(Math.random()*hintPool.length)];
    const t = $("text").value.trim();
    $("text").value = t ? (t + "\n" + "ãƒ»" + hint) : ("ãƒ»" + hint);
    $("text").focus();
  });

  $("saveBtn").addEventListener("click", () => {
    const theme = $("theme").value.trim();
    const text = $("text").value.trim();
    const score = Number($("score").value);

    if (!text) { alert("è¤’ã‚ãŸã„ã“ã¨ã‚’1ã¤æ›¸ã„ã¦ãã ã•ã„ã€‚"); return; }

    const arr = load();
    const editingId = $("saveBtn").getAttribute("data-editing");

    if (editingId) {
      const idx = arr.findIndex(e=> e.id === editingId);
      if (idx >= 0) {
        arr[idx] = { ...arr[idx], theme, text, score, ts: Date.now() };
      }
      $("saveBtn").removeAttribute("data-editing");
      $("saveBtn").textContent = "ä¿å­˜";
    } else {
      arr.push({
        id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()) + Math.random(),
        theme, text, score,
        ts: Date.now()
      });
    }

    saveAll(arr);
    $("text").value = "";
    render();
  });

  $("exportBtn").addEventListener("click", () => {
    const data = JSON.stringify(load(), null, 2);
    const blob = new Blob([data], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "self-praise-diary.json";
    a.click();
    URL.revokeObjectURL(url);
  });

  $("importBtn").addEventListener("click", async () => {
    const input = document.createElement("input");
    input.type = "file";
    input.accept = "application/json";
    input.onchange = async () => {
      const file = input.files?.[0];
      if (!file) return;
      const text = await file.text();
      try {
        const arr = JSON.parse(text);
        if (!Array.isArray(arr)) throw new Error("format");
        saveAll(arr);
        render();
        alert("èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚");
      } catch {
        alert("èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆJSONå½¢å¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼‰ã€‚");
      }
    };
    input.click();
  });

  $("clearBtn").addEventListener("click", () => {
    if (!confirm("å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) return;
    localStorage.removeItem(KEY);
    render();
  });

  $("search").addEventListener("input", render);
  $("todayBtn").addEventListener("click", () => window.scrollTo({top:0, behavior:"smooth"}));

  render();

const praiseLines = [
  "ä»Šæ—¥ã‚‚ã€ã¡ã‚ƒã‚“ã¨ç”Ÿãã¾ã—ãŸã€‚",
  "å°ã•ãªä¸€æ­©ã€ç¢ºã‹ã«é€²ã‚“ã§ã„ã¾ã™ã€‚",
  "ãã‚Œã‚’æ›¸ã‘ãŸæ™‚ç‚¹ã§ã€ã‚‚ã†ååˆ†ã€‚",
  "è‡ªåˆ†ã«å‘ãåˆãˆãŸã®ãŒä¸€ç•ªãˆã‚‰ã„ã€‚",
  "é™ã‹ãªåŠªåŠ›ã€ã¡ã‚ƒã‚“ã¨ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚"
];

function showPraise() {
  const line = praiseLines[Math.floor(Math.random() * praiseLines.length)];
  alert("ğŸŒ™ " + line);
}

showPraise();

</script>
</body>
</html>